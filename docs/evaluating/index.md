---
layout: default
title: Evaluating
nav_order: 4
---


## Evaluating Clustering Quality

When the epitopes of CDR3 sequences are available, *clusTCR* can easily evaluate the quality of the generated clustering.
We start by making a clustering as normal.

```python
from clustcr import Clustering, datasets
cdr3 = datasets.test_cdr3()
result = Clustering().fit(cdr3)
```

#### Epitopes

To plug in the epitope data, *clusTCR* expects a `pandas.Dataframe` containing `CDR3` and `Epitope` columns.
As an example, we have the epitope data for the `test_cdr3` dataset available.

```python
epitopes = datasets.test_epitope()
```

### Metrics

To access the metrics, simply call the metrics method on the clustering result and supply the epitope data.

```python
metrics = result.metrics(epitopes)
```

`Note` The results are compared to a baseline clustering, which is generated by randomly permuting 
the assigned clusters, as to mimic an algorithm that performs random clustering.


#### Retention

Fraction of sequences that is assigned to *any* cluster.

```python
metrics.retention()
>> 0.2853333333333333
```

#### Purity

Fraction of sequences within a cluster targeting the same epitope.  
Returns a tuple of (result, baseline_result).
```python
metrics.purity()
>> (0.8916464891041163, 0.21337772397094432)
```

#### Purity90

Fraction of clusters that have a purity greater than 90%.  
Returns a tuple of (result, baseline_result).

```python
metrics.purity_90()
>> (0.8916464891041163, 0.21337772397094432)
```

#### Consistency

Fraction of sequences targeting the same epitope that are assigned to the same cluster.  
Returns a tuple of (result, baseline_result).

```python
metrics.consistency() TODO correct results
>> (0.8916464891041163, 0.21337772397094432)
```

#### Summary

All available clustering metrics and as a `pandas.DataFrame`.

```python
metrics.summary() TODO results
>> pandas.Dataframe
```
